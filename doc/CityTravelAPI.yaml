openapi: 3.0.1
info:
  title: City Travel API
  version: "1.0"
servers:
  - url: https://CityTravelAPI
tags:
  - name: Line
    description: Operaciones para realizar con las lineas de transporte
  - name: Train
    description: Operaciones para realizar con los trenes en las lineas de transporte
  - name: Station
    description: Operaciones para realizar con las estaciones de la linea de transporte
  - name: Garage
    description: Operaciones para realizar con las cocheras y talleres en las diferentes estaciones que dispongan de ellas.
  - name: Access
    description: Operaciones para realizar con los accesos y servicios que poseé cada estación.
paths:
  /Line:
    get:
      tags:
        - Line
      summary: Listado de lineas de transporte
      description: Devuelve el listado completo de todas las lineas de transporte. Es posible filtrar por la horarios de inicio del servicio, fin del servicio o ambos
      operationId: getLines
      parameters:
        - name: fisrtHour
          in: query
          description: Filtro por hora de inicio del servicio
          required: false
          schema:
            type: string
            format: 'date-time'
            default: "00:00"
        - name: lastHour
          in: query
          description: Filtro por hora del último servicio
          required: false
          schema:
            type: string
            format: 'date-time'
            default: "00:00"
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Se devuelve el listado de lineas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Line'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - Line
      summary: Añadir lineas de transporte
      description: Podemos añadir las lineas de transporte. Con diferentes parámetros.
      operationId: postLine
      security:
        - bearerAuth: [ ]
      requestBody:
        $ref: '#/components/requestBodies/postLine'
      responses:
        '201':
          description: El producto se registra correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LineIn'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /line/{id}:
    parameters:
      - $ref: '#/components/parameters/Id'
    get:
      tags:
        - Line
      security:
        - bearerAuth: [ ]
      summary: Listado de lineas de transporte por medio de su Id
      description: Devuelve los datos relativos a la linea seleccionada por su id.
      operationId: getLinesById
      responses:
        '200':
          description: Se devuelve el listado de lineas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Line'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Line
      summary: Eliminar una Line por su Id
      description: Eliminamos una linea por su ID
      operationId: deleteLineById
      responses:
        '204':
          $ref: '#/components/responses/NoContent'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - Line
      summary: Modifica una linea
      description: Modifica atributos de la linea, buscandola por su Id de identificación
      operationId: putLineById
      requestBody:
        $ref: '#/components/requestBodies/postLine'
      responses:
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'
    patch:
      tags:
        - Line
      summary: Modificación de un campo especifico de la linea seleccioanda por su id
      operationId: patchLineById
      requestBody:
        description: Nombre y valor del campo que se modifica
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchLine'
      responses:
        '200':
          description: Se devuelve la linea
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Line'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /line/{lineId}/trains:
    parameters:
      - $ref: '#/components/parameters/Id'
    get:
      tags:
        - Line
        - Train
      summary: Listado de trenes correspondientes a una linea por el identificador de esta
      description: Devuelve un listado completo de trenes que circulan por una linea identificada con su Id
      operationId: getTrainsByLineId
      security:
        - bearerAuth: [ ]
      responses:
        '200':
          description: Se devuelve el listado de los trenes de la linea
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LineTrain'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'


  /train:
    get:
      tags:
        - Train
      summary: Recibimos el listado total de trenes
      description: Recibimos el listado total de trenes, pudiendo filtrar por número de vagones, asientos o de pie.
      operationId: getTrains
      parameters:
        - name: numwagons
          in: query
          description: Indicación del numero de vagones por el que se queire filtrar
          required: false
          schema:
            type: number
            format: int32
            default: 0
        - name: numSeats
          in: query
          description: Indicación del numero de asientos por el que se quiere filtrar
          required: false
          schema:
            type: number
            format: int32
            default: 0
        - name: numStandUp
          in: query
          description: Indicación del numero de plazas de pie  por el que se quiere filtrar
          required: false
          schema:
            type: number
            format: int32
            default: 0
      responses:
        '200':
          description: Se devuelve el listado completo de trenes si no se introduce filtros. 
                       En caso contrario el listado completo dependiendo de los filtros
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LineTrain'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /train/{id}:
    parameters:
      - $ref: '#/components/parameters/Id'
    get:
      tags:
        - Train
      security:
        - bearerAuth: [ ]
      summary: Atributos correspondientes a un tren por su identificador
      description: Devuelve los atributos de un tren por medio del identificador de este
      operationId: getTrainById
      responses:
        '200':
          description: Se devuelve el listado de lineas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LineTrain'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - Train
      summary: Modificar un tren por su Identificador
      operationId: putTrainById
      requestBody:
        $ref: '#/components/requestBodies/putTrainId'
      responses:
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'
    patch:
      tags:
        - Train
      summary: Modificación de un campo especifico de el tren seleccionado por su id
      operationId: patchTrainById
      requestBody:
        description: Se puede modificar asientos, vagones y plazas de pie
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchTrain'
      responses:
        '202':
          description: Se devuelve el tren
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LineTrain'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Train
      summary: Eliminar un tren por el identificador del mismo
      description: Eliminamos una linea por su número de Id
      operationId: deleteTrainById
      responses:
        '204':
          $ref: '#/components/responses/NoContent'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /train/{lineId}/train:
    parameters:
      - $ref: '#/components/parameters/Id'
    post:
      tags:
        - Train
      summary: Añadir tren en una linea por el Id de la Linea
      description: Podemos añadir un tren a una linea esecificando el ide de la linea
      operationId: postTrainByIdLine
      security:
        - bearerAuth: [ ]
      requestBody:
        $ref: '#/components/requestBodies/postTrainByIdLine'
      responses:
        '201':
          description: El producto se registra correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LineTrain'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /station:
    get:
      tags:
        - Station
      parameters:
        - name: wifi
          in: query
          description: Filtro disponibilidad servicio wifi
          required: false
          schema:
            type: boolean
        - name: busStation
          in: query
          description: Filtro enlace con estacion de autobuses
          required: false
          schema:
            type: boolean
        - name: taxiStation
          in: query
          description: Filtro enlace estacion de taxis
          required: false
          schema:
            type: boolean
      security:
        - bearerAuth: [ ]
      summary: Atributos correspondientes a una estacion
      description: Devuelve los atributos de una estacion
      operationId: getStation
      responses:
        '200':
          description: Se devuelve el listado de estaciones
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OutStation'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /station/{id}:
    parameters:
      - $ref: '#/components/parameters/Id'
    get:
      tags:
        - Station
      security:
        - bearerAuth: [ ]
      summary: Atributos correspondientes a una estación por su identificador
      description: Devuelve los atributos de una estacón por medio del identificador de este
      operationId: getStationById
      responses:
        '200':
          description: Se devuelve la estacion
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LineStation'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - Station
      summary: Modificar una estación por su Identificador
      operationId: putStationById
      requestBody:
        $ref: '#/components/requestBodies/putStationId'
      responses:
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Station
      summary: Eliminar una estación por su Identificador
      operationId: deleteStationId
      requestBody:
        $ref: '#/components/requestBodies/putStationId'
      responses:
        '500':
          $ref: '#/components/responses/InternalServerError'
        '204':
          $ref: '#/components/responses/NoContent'
  /station/{StationId}/satation:
    parameters:
    - $ref: '#/components/parameters/Id'
    patch:
      tags:
        - Station
      summary: Modificación de los campor de horario de la estacion por el id de esta
      operationId: patchStationId
      requestBody:
        description: Se puede modificar horarios de apertura y cierra
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchStation'
      responses:
        '202':
          description: Se devuelve la estación
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LineStation'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /station/{LineId}/station:
    parameters:
      - $ref: '#/components/parameters/Id'
    post:
      tags:
        - Station
      summary: Añadir datos parciales de una estación por el Id de una linea
      description: Podemos añadir una eestación a una linea esecificando el ide de la linea
      operationId: postStationByIdLine
      security:
        - bearerAuth: [ ]
      requestBody:
        $ref: '#/components/requestBodies/postStationByIdLine'
      responses:
        '201':
          description: El producto se registra correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GaraageDTO'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /garage:
    get:
      tags:
        - Garage
      parameters:
        - name: taller
          in: query
          description: Filtro disponibilidad talleres en el garage
          required: false
          schema:
            type: boolean
        - name: rrhh
          in: query
          description: Filtro disponibilidad de recursos humanos en el garage
          required: false
          schema:
            type: boolean
        - name: paintservice
          in: query
          description: Filtro disponibilidad servicio de pintura en el garage
          required: false
          schema:
            type: boolean
      summary: Atributos correspondientes a un garage o cochera
      description: Devuelve filtrado por los atributos del garage o cochera
      operationId: getGarage
      responses:
        '200':
          description: Se devuelve el listado de Garages
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/GaraageDTO'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundException'
        '500':
          $ref: '#/components/responses/InternalServerError'







components:

  securitySchemes:
    bearerAuth: # arbitrary name for the security scheme
      type: security
      scheme: bearer
      bearerFormat: JWT

  schemas:
    LineIn:
      type: object
      properties:
        codeLine:
          type: string
          format: string
          description: Código de la linea
          example: "L-111"
        color:
          type: string
          format: string
          description: Color de la linea
          example: Red
        firstTime:
          type: string
          format: 'date-time'
          description: Horario de apertura de la linea
          example: "06:45"
        LastTime:
          type: string
          format: 'date-time'
          description: Horario de cierre de la linea
          example: "23:00"
        stopTime:
          type: integer
          format: int32
          description: Tiempo de parada en las estaciones
          example: 5
        period:
          type: integer
          format: int32
          description: Frecuencia de paso
          example: 5

    Line:
      type: object
      properties:
        id:
          type: number
          format: int32
          description: Código Id de la estación
          example: 12
        codeLine:
          type: string
          format: string
          description: Código de la linea
          example: "L-321"
        color:
          type: string
          format: string
          description: Color de la linea
          example: Red
        firstTime:
          type: string
          format: 'date-time'
          description: Horario de apertura de la linea
          example: "06:45"
        LastTime:
          type: string
          format: 'date-time'
          description: Horario de cierre de la linea
          example: "23:00"
        stopTime:
          type: integer
          format: int32
          description: Tiempo de parada en las estaciones
          example: 5
        Station:
          $ref: '#/components/schemas/LineStation'
    LineAccess:
      type: object
      properties:
        Id:
          type: number
          format: int32
          description: Número identificación del acceso
          example: 23
        street:
          type: string
          format: string
          description: Dirección de la calle donde se situa el acceso a la estación
          example: 'Avda Barcelona'
        num:
          type: number
          format: int32
          description: Número de la calle donde se situa el acceso
          example: 291
        latitude:
          type: number
          format: int32
          description: Punto latitud del acceso
          example: 23.2345
        longitude:
          type: number
          format: int32
          description: Punto longitud del acceso
          example: 12.456
        elevator:
          type: boolean
          format: boolean
          description: Indicación si el acceso dispone de ascensores
    LineGarage:
      type: object
      properties:
        Id:
          type: number
          format: int32
          description: Número identificación del garage
          example: 2
        codeGarage:
          type: string
          format: string
          description: Código de identificación del garage
          example: 'G-234'
        taller:
          type: boolean
          format: boolean
          description: Indicación si el garage dispone de taller de reparaciones
        surface:
          type: number
          format: int32
          description: Indicación si el garage dispone de taller de reparaciones
          example: 234.45
        rrhh:
          type: boolean
          format: boolean
          description: Indicación si el garage dispone de recursos humanos
        paintService:
          type: boolean
          format: boolean
          description: Indicación si el garage dispone de taller de pintura
    LineStation:
      type: object
      properties:
        id:
          type: number
          format: int32
          description: Código Id de la estación
          example: 12
        name:
          type: string
          format: string
          description: nombre de la estacion
          example: "San Clemencio"
        hopen:
          type: string
          format: 'date-time'
          description: Horario de apertura de la estacion
          example: "06:45"
        hcose:
          type: string
          format: 'date-time'
          description: Horario de cierre de la estacion
          example: "23:00"
        ptoInfo:
          type: boolean
          format: boolean
          description: Indicación se dispone de punto de informacion de la red
        wifi:
          type: boolean
          format: boolean
          description: Indicación si dispone de puntos de acceso wifi
        bus_station:
          type: boolean
          format: boolean
          description: Indicación si dispone de enlace con estación de autobus
        taxi_station:
          type: boolean
          format: boolean
          description: Indicación si dispone de enlace con estación de taxis
        LineAccess:
          $ref: '#/components/schemas/LineAccess'
        LineGarage:
          $ref: '#/components/schemas/LineGarage'

    OutStation:
      type: object
      properties:
        id:
          type: number
          format: int32
          description: Código Id de la estación
          example: 12
        name:
          type: string
          format: string
          description: nombre de la estacion
          example: "San Clemencio - STATION"
        hopen:
          type: string
          format: 'date-time'
          description: Horario de apertura de la estacion
          example: "06:45"
        hcose:
          type: string
          format: 'date-time'
          description: Horario de cierre de la estacion
          example: "23:00"

    LineTrain:
      type: object
      properties:
        id:
          type: number
          format: int32
          description: Código Id del tren
          example: 4
        codeTrain:
          type: string
          format: string
          description: Código de identificación del tren
          example: 'GHF-234'
        model:
          type: string
          format: string
          description: Módelo de locomotora
          example: 'REFLEX-23V'
        numWagons:
          type: number
          format: int32
          description: Número de vagones del que dispone el tren
          example: 10
        numSeats:
          type: number
          format: int32
          description: Número de asientos totales que dispone el tren
          example: 160
        numStandUp:
          type: number
          format: int32
          description: Número de plazas de pie que dispone el tren
          example: 240
        dateBuy:
          type: string
          format: 'date-time'
          description: Fecha de adquisición del tren
          example: '23-02-1998'
    OutLineDTO:
      type: object
      properties:
        codeLine:
          type: string
          format: string
          description: Código identificativo de la linea
          example: "L-123"
        firstTime:
          type: string
          format: 'date-time'
          description: Horario de inicio del servicio
          example: "06:30"
        lastTime:
          type: string
          format: 'date-time'
          description: Horario de último servicio
          example: "23:30"
        Station:
          $ref: '#/components/schemas/OutLineDTO'
    GaraageDTO:
      type: object
      properties:
        id:
          type: integer
          format: int32
          description: Número identificador
          example: '5'
        codeGarage:
          type: string
          format: string
          description: Código de la cochera o garage
          example: 'GST-238'
    PatchLine:
      properties:
        field:
          type: string
          example: "CodeLine"
        value:
          type: string
          example: 'C-245'
    PatchStation:
      type: object
      properties:
        hopen:
          type: string
          format: string
          description: Hora de apertura de la estacion
          example: '06:15'
        hclose:
          type: string
          format: string
          description: Hora de cierre de la estacion
          example: '23:15'

    PostStationByIdLine:
      type: object
      properties:
        name:
          type: string
          format: string
          description: Nombre de la estación
          example: 'Blockshire-STATION'
        hopen:
          type: string
          format: string
          description: horario de apertura de la estacion
          example: "05:00"
        hclose:
          type: string
          format: string
          description: Horaio de cierre de la estacion
          example: '23:45'

    PutStationIn:
      type: object
      properties:
        id:
          type: number
          format: int32
          description: Código Id de la estación
          example: 12
        name:
          type: string
          format: string
          description: nombre de la estacion
          example: "San Clemencio"
        hopen:
          type: string
          format: 'date-time'
          description: Horario de apertura de la estacion
          example: "06:45"
        hcose:
          type: string
          format: 'date-time'
          description: Horario de cierre de la estacion
          example: "23:00"
        ptoInfo:
          type: boolean
          format: boolean
          description: Indicación se dispone de punto de informacion de la red
        wifi:
          type: boolean
          format: boolean
          description: Indicación si dispone de puntos de acceso wifi
        bus_station:
          type: boolean
          format: boolean
          description: Indicación si dispone de enlace con estación de autobus
        taxi_station:
          type: boolean
          format: boolean
          description: Indicación si dispone de enlace con estación de taxis

    PatchTrain:
      type: object
      properties:
        numWagons:
          type: number
          format: int32
          description: Número de vagones del que dispone el tren
          example: 10
        numSeats:
          type: number
          format: int32
          description: Número de asientos totales que dispone el tren
          example: 234
        numStandUp:
          type: number
          format: int32
          description: Número de plazas de pie disponibles
          example: 133

    ErrorResponse:
      properties:
        errorCode:
          type: number
          format: int32
          example: 500
        message:
          type: string
          example: Validation error
    NoFound:
      properties:
        errorCode:
          type: number
          format: int32
          example: 404
        message:
          type: string
          example: Line not found
  parameters:
    Id:
      name: id
      in: path
      description: Número ID identificador
      required: true
      schema:
        type: number
        format: int32
        example: 32

  requestBodies:
    postLine:
      description: Datos de una linea nueva
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/LineIn'
    postTrainByIdLine:
      description: Datos de un nuevo tren
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/LineTrain'
    putTrainId:
      description: Datos de un tren
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/LineTrain'
    putStationId:
      description: Datos de una estación
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/PutStationIn'
    postStationByIdLine:
      description: Datos de la nueva estación en la línea
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/PostStationByIdLine'

  responses:
    NoContent:
      description: No content
    InternalServerError:
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            errorCode: 500
            message: "Se ha producido un error en el servidor"
    NotFoundException:
      description: Objeto no encontrado
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/NoFound'
          example:
            errorCode: 404
            message: 'Line not found'
    UnauthorizedError:
      description: Access token is missing or invalid
security:
  - bearerAuth: []




